!-------------------------------------------------------------------------------
! Name: neural_net_constants.F90
!
! Purpose:
! Module containing the neutral net constants
!
! Examples:
! ex1 and ex2 used for prototype
! ex3,ex4,ex5 used for FBL1 trained with GAC NOAA18
! ex6,ex7,ex8 used for FBL2 trained with PYGAC NOAA18 ( w. NISE sea-ice, etc)
! ex9,ex10,ex11 used for FBL3 trained with PYGAC NOAA18 (w. ECMWF sea-ice, etc)
!
! History:
! 2014/10/23, SS: Original version
! 2014/11/04, SS+OS: added constants for new cloud mask, which is now
!    also available for twilight and additionally uses ECMWF skin temperature
!    and flags for snow/ice and land/sea
! 2015/08/22, SS: added cloud masks 6-11
! 2016/02/18, SS: added cloud masks 12-14 for AVHRR1
! 2017/06/21, SS: added cloud masks 20-33
! 2017/06/29, SS: added new coefficients for 1.6um ANN
!
! $Id$
!
! Bugs:
! None known.
!-------------------------------------------------------------------------------

module neural_net_constants_m

  use common_constants_m

  implicit none

  ! common variables of all cloud masks
  integer :: noutput = 1


  ! put in this module different sections for the groups of constants of the
  ! different neural nets

  ! 1.) cm_orac_day_extended_nn
  real, parameter :: temperature_ex1=1.0,bias_h_ex1=1.0, &
       bias_i_ex1=1.0,cutoff_ex1=80.0

  integer(kind=lint), parameter :: ninput_ex1=6,nneurons_ex1=50
  real(kind=sreal) :: minmax_train_ex1(ninput_ex1,2), &
       inv_ex1(ninput_ex1+1,nneurons_ex1), &
       outv_ex1(nneurons_ex1+1), &
       scales_ex1(ninput_ex1,2),oscales_ex1(3)

  ! min and max values of training dataset:
  data minmax_train_ex1(1,:) / 1.000000000E+02, 1.050000000E+03 / ! ctp
  data minmax_train_ex1(2,:) / 1.886499939E+02, 3.199400024E+02 / ! ctt
  data minmax_train_ex1(3,:) / 9.999999776E-03, 2.560000043E+02 / ! cot
  data minmax_train_ex1(4,:) / 2.406600037E+02, 3.199899902E+02 / ! stemp
  data minmax_train_ex1(5,:) / 0.000000000E+00, 1.139899902E+02 / ! stemp-ctt
  data minmax_train_ex1(6,:) / 0.000000000E+00, 1.000000000E+00 / ! sea/land

  ! scaling factors for input vector
  data scales_ex1(1,:) / 5.000000075E-02, 9.473683895E-04 / ! ctp
  data scales_ex1(2,:) / 5.000000075E-02, 6.855052896E-03 / ! ctt
  data scales_ex1(3,:) / 5.000000075E-02, 3.525816603E-03 / ! cot
  data scales_ex1(4,:) / 5.000000075E-02, 1.134501584E-02 / ! stemp
  data scales_ex1(5,:) / 5.000000075E-02, 7.895429619E-03 / ! stemp-ctt
  data scales_ex1(6,:) / 5.000000075E-02, 8.999999762e-01 / ! sea/land

  ! scaling factors for output vector
  data oscales_ex1 / 1.000000015E-01, 7.999999523E-01, 0.000000000E+00 / ! final output scales

  ! input weights
  data inv_ex1(1,:) /  -1.198862076E+02, &
       & 7.203685284E+00, &
       & -1.144907379E+01, &
       & 2.223655701E+01, &
       & 1.706274605E+01, &
       & 3.622603607E+01, &
       & -6.052127838E+00, &
       & 9.285201263E+01, &
       & -5.885888100E+00, &
       & -1.244063187E+02, &
       & 1.120351887E+01, &
       & -1.863928680E+02, &
       & 3.331762695E+01, &
       & 5.102208710E+01, &
       & -1.027408409E+01, &
       & -8.418350983E+01, &
       & -7.048767090E+01, &
       & -9.214209557E+00, &
       & -1.268842602E+01, &
       & -5.051583290E+00, &
       & -4.393682098E+01, &
       & -4.731553555E+00, &
       & -1.625827026E+02, &
       & 1.828236008E+01, &
       & 3.135302925E+01, &
       & -7.976469994E+00, &
       & -1.322703400E+02, &
       & -1.382856083E+01, &
       & 1.511012421E+02, &
       & -6.194180965E+00, &
       & -9.821899414E+01, &
       & -1.743140030E+01, &
       & -2.583047791E+02, &
       & 2.339094696E+02, &
       & 5.384585190E+01, &
       & 1.129486847E+02, &
       & -2.876932907E+01, &
       & -5.122366905E+00, &
       & 8.248775482E+01, &
       & -1.653131866E+01, &
       & 2.586689949E+01, &
       & -2.045112801E+01, &
       & -3.609018250E+02, &
       & -7.971093655E+00, &
       & -1.254727173E+02, &
       & -3.532891846E+01, &
       & -8.295223999E+01, &
       & -8.297009277E+01, &
       & 4.602634888E+02, &
       & 1.066375828E+01 /

  data inv_ex1(2,:) / 1.612140465E+01, &
       & -3.790495300E+01, &
       & -8.787001610E+00, &
       & -1.393690491E+01, &
       & -6.420500946E+01, &
       & 5.738274574E+00, &
       & -7.408140659E+00, &
       & -5.283596039E+01, &
       & -4.455620766E+00, &
       & -1.094180069E+02, &
       & -7.070936584E+01, &
       & 8.698648071E+01, &
       & 6.754272461E+01, &
       & 1.920607758E+01, &
       & -9.003817558E+00, &
       & 7.629393768E+01, &
       & 3.132918358E+00, &
       & -6.036241055E+00, &
       & -8.663392067E+00, &
       & -4.342136860E+00, &
       & -3.562760162E+01, &
       & -5.524582386E+00, &
       & -2.392570801E+02, &
       & -6.074672318E+01, &
       & 3.278195858E+00, &
       & -5.909499168E+00, &
       & 9.205098724E+01, &
       & -7.739297867E+00, &
       & -5.554956818E+01, &
       & -3.564874172E+00, &
       & -5.218248844E+00, &
       & 1.113358021E+01, &
       & 2.460436440E+01, &
       & 4.094768524E+01, &
       & -1.247150421E+02, &
       & 5.181007385E+01, &
       & -1.990428925E+01, &
       & -7.620372772E+00, &
       & -7.713142395E+01, &
       & 2.324980545E+01, &
       & -2.829788208E+02, &
       & -7.988356590E+00, &
       & -3.758363962E+00, &
       & -7.387834072E+00, &
       & -3.346448898E+00, &
       & -2.850118408E+02, &
       & 6.895471096E+00, &
       & -4.942391205E+01, &
       & -5.657720947E+02, &
       & -1.024770660E+02 /

  data inv_ex1(3,:) / 9.518052673E+01, &
       & -1.844642258E+01, &
       & -4.411327362E+00, &
       & 3.234172821E+01, &
       & 1.170220089E+01, &
       & -4.797799301E+01, &
       & -9.183178902E+00, &
       & -1.441193867E+01, &
       & -2.282765007E+01, &
       & -2.555795097E+01, &
       & -1.230598526E+02, &
       & 2.333709259E+02, &
       & -2.850907898E+02, &
       & -1.280115967E+02, &
       & -1.341921616E+01, &
       & -1.768520813E+02, &
       & -1.434201622E+01, &
       & -7.496619701E+00, &
       & -1.670005608E+01, &
       & -9.728239059E+00, &
       & -4.310174866E+02, &
       & -2.407846069E+01, &
       & -3.016573334E+01, &
       & -1.134025345E+02, &
       & -7.803428650E+01, &
       & -6.765100479E+00, &
       & 1.595781097E+02, &
       & -1.203033352E+01, &
       & -6.228601837E+01, &
       & -1.952122116E+01, &
       & -7.435932159E+01, &
       & -4.648562012E+02, &
       & 1.057270966E+02, &
       & -2.605762024E+02, &
       & -4.033936310E+01, &
       & -1.137770309E+02, &
       & 4.252502823E+01, &
       & -1.866457558E+01, &
       & -2.225055504E+01, &
       & -4.886537075E+00, &
       & 2.872278748E+02, &
       & -1.652827637E+03, &
       & -5.505376339E+00, &
       & -1.046708202E+01, &
       & -4.734085464E+01, &
       & -1.800419688E+00, &
       & -1.430429840E+02, &
       & 3.414466858E+01, &
       & -5.019979477E+01, &
       & -1.733241119E+02 /

  data inv_ex1(4,:) / -6.878179550E+00, &
       & 1.054172611E+01, &
       & 3.326992989E+00, &
       & 2.506871796E+01, &
       & -3.875917816E+01, &
       & 2.747989464E+01, &
       & -4.344241142E+00, &
       & -7.583637238E+01, &
       & -2.182597351E+01, &
       & -1.254369659E+02, &
       & -4.242182159E+01, &
       & 7.485914612E+01, &
       & 5.432384109E+01, &
       & -4.501142120E+01, &
       & -7.134100437E+00, &
       & 6.762934113E+01, &
       & 3.765483499E-01, &
       & -4.031041622E+00, &
       & -4.132584095E+00, &
       & -6.353750229E+00, &
       & -5.333652496E+01, &
       & -2.654502296E+01, &
       & -3.620485687E+01, &
       & -1.022409668E+02, &
       & 3.700888062E+01, &
       & -4.374005795E+00, &
       & 3.880986786E+01, &
       & 1.199767739E-01, &
       & 8.079289436E+00, &
       & -1.640043259E+01, &
       & 3.618713379E+01, &
       & -2.219234467E+01, &
       & -1.109210968E+02, &
       & -1.672563171E+01, &
       & -1.604607544E+02, &
       & 8.822590637E+01, &
       & 2.969067764E+01, &
       & -1.361190891E+01, &
       & -8.320675659E+01, &
       & 2.896755219E+01, &
       & -1.697809448E+02, &
       & 1.098860741E+00, &
       & -1.956713295E+01, &
       & -3.112687111E+00, &
       & -2.232637596E+01, &
       & -1.747324066E+02, &
       & 2.596947479E+01, &
       & -1.392198639E+02, &
       & -4.216513672E+02, &
       & -1.146884308E+02 /

  data inv_ex1(5,:) / 9.031204987E+01, &
       & 5.738229752E+01, &
       & 9.739771843E+00, &
       & 6.906047821E+01, &
       & -2.564931641E+02, &
       & -3.298867035E+01, &
       & -6.477060318E-01, &
       & 7.131658173E+01, &
       & -1.550419712E+01, &
       & -8.956081390E+01, &
       & 3.059384155E+02, &
       & -1.669346619E+02, &
       & -5.735593414E+01, &
       & -1.692713928E+02, &
       & -1.004926324E+00, &
       & 3.143511963E+02, &
       & 5.192165375E+01, &
       & -2.824472427E+00, &
       & -2.192189455E+00, &
       & -4.347306728E+00, &
       & -5.748682404E+01, &
       & -2.240583611E+01, &
       & 1.499136963E+02, &
       & -3.053393860E+02, &
       & 2.107374191E+00, &
       & -1.866863012E+00, &
       & -1.099206543E+02, &
       & 2.811237097E+00, &
       & 2.031931610E+02, &
       & -1.651590729E+01, &
       & 2.677508354E+01, &
       & -2.814767456E+01, &
       & -1.660997620E+02, &
       & 4.345346451E+01, &
       & 7.705832672E+01, &
       & 5.703025513E+02, &
       & 5.964844131E+01, &
       & -9.573694229E+00, &
       & 4.723513031E+01, &
       & -3.242170334E+01, &
       & -4.185624084E+02, &
       & -1.205600834E+01, &
       & -1.986046028E+01, &
       & 9.590914249E-01, &
       & -4.516469955E+00, &
       & -8.327405548E+01, &
       & 5.633608246E+01, &
       & 2.813710594E+01, &
       & 1.341103668E+02, &
       & 5.289632416E+01 /

  data inv_ex1(6,:) / 1.281319122E+02, &
       & -1.343738461E+01, &
       & 2.260223627E+00, &
       & -4.430667877E+01, &
       & 8.923987389E+00, &
       & 2.425005150E+01, &
       & -8.322486281E-01, &
       & 5.176723480E+01, &
       & -1.019532776E+01, &
       & 5.406110764E+01, &
       & -3.697178650E+01, &
       & 1.447919559E+01, &
       & 2.743006897E+01, &
       & -1.191062450E+00, &
       & 3.261048317E+00, &
       & -3.450173645E+02, &
       & 5.960262680E+01, &
       & 1.977336049E+00, &
       & 4.180079460E+00, &
       & 1.353198528E+00, &
       & -6.018501663E+01, &
       & -1.209468269E+01, &
       & 3.903492355E+01, &
       & 1.881533623E+01, &
       & -1.214582157E+01, &
       & 6.019473076E-01, &
       & -8.726773834E+01, &
       & -4.497830868E-01, &
       & -3.054907036E+01, &
       & -7.797265053E+00, &
       & 4.651377869E+01, &
       & -4.639128494E+01, &
       & 1.520531769E+02, &
       & 2.959090996E+01, &
       & 1.623004456E+02, &
       & 2.867351151E+01, &
       & -4.254205704E+01, &
       & -5.544476509E+00, &
       & 6.779790497E+01, &
       & 1.963472748E+01, &
       & -1.195828629E+02, &
       & 1.564632058E+00, &
       & -1.068582726E+01, &
       & 8.030436933E-02, &
       & 3.455360413E+01, &
       & -6.817080975E+00, &
       & 4.266560745E+01, &
       & -1.531602669E+01, &
       & -2.847937927E+02, &
       & -1.437376251E+02 /

  data inv_ex1(7,:) /  -3.608822250E+01, &
       & -1.841540527E+01, &
       & -8.987768173E+00, &
       & -6.186726379E+01, &
       & 5.145254135E+01, &
       & -5.781642914E+01, &
       & -1.125493336E+01, &
       & -6.042827225E+01, &
       & -8.712173462E+00, &
       & 7.464002228E+01, &
       & 2.706512260E+01, &
       & -3.189232111E+00, &
       & -8.444677734E+01, &
       & -2.106271744E+01, &
       & -1.665872955E+01, &
       & 1.455708027E+01, &
       & -3.739911270E+01, &
       & -1.359965324E+01, &
       & -1.657565117E+01, &
       & -1.291583729E+01, &
       & 1.005515594E+02, &
       & -1.000794792E+01, &
       & -1.214395065E+02, &
       & 7.893986511E+01, &
       & -2.423956490E+01, &
       & -1.275158310E+01, &
       & -3.590878677E+01, &
       & -1.086503410E+01, &
       & -1.152904892E+02, &
       & -9.745239258E+00, &
       & 5.767009735E+00, &
       & 4.466145325E+01, &
       & -3.586954117E+01, &
       & -2.070370636E+02, &
       & 1.499499917E+00, &
       & -1.846095123E+02, &
       & -5.115365982E+01, &
       & -8.952252388E+00, &
       & -4.469993973E+01, &
       & -1.853708839E+01, &
       & 1.756760864E+02, &
       & 9.872690582E+01, &
       & 4.433529663E+01, &
       & -1.150437546E+01, &
       & 4.274181747E+01, &
       & 1.678093567E+02, &
       & -7.601883411E+00, &
       & 1.408024597E+02, &
       & 8.176857758E+01, &
       & 1.626640930E+02 /

  ! output weights
  data outv_ex1 / 6.541716003E+01, &
       & 9.864802551E+01, &
       & 8.040759087E+00, &
       & -2.958720093E+02, &
       & -1.584323883E+02, &
       & 6.449095154E+01, &
       & 4.337008476E+00, &
       & -2.290435944E+02, &
       & 1.130992126E+01, &
       & 4.033623047E+02, &
       & -2.847251129E+01, &
       & 4.850612640E+01, &
       & -9.685515594E+01, &
       & 1.008128967E+02, &
       & 6.409172058E+00, &
       & 9.513730621E+01, &
       & 1.131791534E+02, &
       & 2.292799234E+00, &
       & 6.866987705E+00, &
       & 2.887382507E+00, &
       & 1.437620239E+02, &
       & 1.369629192E+01, &
       & -1.961001587E+02, &
       & 8.283555603E+01, &
       & 4.019910431E+01, &
       & 2.999962091E+00, &
       & 7.879821777E+01, &
       & 1.346807241E+00, &
       & -5.389497375E+01, &
       & 9.143481255E+00, &
       & -6.345621872E+01, &
       & -2.195306702E+02, &
       & -7.122614288E+01, &
       & -4.531547546E+01, &
       & 3.958240509E+01, &
       & 6.701979065E+01, &
       & 2.002819061E+02, &
       & 8.520143509E+00, &
       & 2.245739441E+02, &
       & 4.765984726E+01, &
       & 7.505477142E+01, &
       & -2.456705017E+02, &
       & -1.286151733E+02, &
       & 3.869184732E+00, &
       & -1.032429047E+02, &
       & -2.458462372E+02, &
       & 7.747393036E+01, &
       & 4.480058289E+01, &
       & 3.969955826E+01, &
       & 8.078927612E+01, &
       & -1.868996277E+02 /


