<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Phil Watts">
   <meta name="GENERATOR" content="Mozilla/4.72 [en] (X11; I; OSF1 V5.1 alpha) [Netscape]">
</head>
<body>

<center><font size=+1><b>Overview</b>: Setting Measurement Noise Covariance</font>
<hr WIDTH="100%"></center>
This overview is intended to cover the subject of setting the level of
measurement noise assumed in the inversion stage. The system assumes all
error sources are zero mean and normally distributed so that calibration
errors, for example, are not considered. We provide <a href="#General">general</a>
comments followed by a <a href="#Implementation">detailed</a> description
of the ECP implementation.
<hr WIDTH="100%">
<br><a NAME="General"></a><b><font color="#FF0000">General</font></b>
<p>There are two sources of random noise:
<blockquote>1. <b>Instrument</b> - basic radiometric noise in the measurements
from the detector + electronics etc.
<br>2. <b>Equivalent</b> <b>Model parameter (EQMPN) </b>- effective noise
arising from errors in the radiative transfer model. Those considered currently
in the ECP are:
<blockquote>2.1<b> Rs</b> - arising from uncertainties in the assumed surface
reflectivity.
<br>2.2 <b>T/H</b> - arising from uncertainties in the assumed temperature
/ humidity structure of the atmosphere. (Note this term is not currently
supported in the ECP.)
<br>2.3 <b>HOMOG</b> - arising from inhomogenous structure in the real
cloud that is not modelled in the LUTs (derived from a plane-parallel model
in the delivery ECP)
<br>2.4 <b>COREG</b> - arising from co-registration errors in the different
channels</blockquote>
</blockquote>
As concerns setting these noise levels in the ECP, noise terms can have
different dependencies:
<blockquote>1. <b>Instrument dependent</b>
<br>2. <b>Pixel dependent </b>- i.e. change depending on the pixel observed)
<br>3. <b>State dependent</b> - i.e. change depending on the currently
estimated values of the state vector (cloud conditions)</blockquote>
We can summarise the various contributions and their dependencies:
<br>&nbsp;
<center><table BORDER NOSAVE >
<tr>
<td><b><font color="#FF0000">Source</font></b></td>

<td><b><font color="#33CC00">Dependencies></font></b></td>

<td><b><font color="#33CC00">Instrument</font></b></td>

<td><b><font color="#33CC00">Super-pixel</font></b></td>

<td><b><font color="#33CC00">State</font></b></td>
</tr>

<tr NOSAVE>
<td><font color="#FF0000">Instrument</font>:</td>

<td NOSAVE><font color="#FF0000">Radiometric</font></td>

<td><b>Yes</b></td>

<td>No</td>

<td>No</td>
</tr>

<tr>
<td><font color="#FF0000">Model parameter</font>:</td>

<td><font color="#FF0000">Rs</font></td>

<td>No</td>

<td>No</td>

<td><b>Yes</b></td>
</tr>

<tr>
<td></td>

<td><font color="#FF0000">T/H(z)</font></td>

<td>No</td>

<td>No</td>

<td><b>Yes</b></td>
</tr>

<tr>
<td></td>

<td><font color="#FF0000">HOMOG</font></td>

<td>No</td>

<td><b>Yes</b></td>

<td>No</td>
</tr>

<tr>
<td></td>

<td><font color="#FF0000">COREG</font></td>

<td>No</td>

<td><b>Yes</b></td>

<td>No</td>
</tr>
</table></center>

<hr WIDTH="100%">
<br><a NAME="Implementation"></a><b><font color="#FF0000">Implementation</font></b>
<p>The implementation in the ECP proceeds logically as follows:
<p><b><font color="#33CC00">1. Instrument dependent terms:</font></b>
<br>At ingest (specifically within <b>Read_Chan</b> routine), radiometric
noise specifications from the channel configuration files are loaded into
a measurement covariance variable <b>Ctrl%Sy</b>. This square symmetric
array is <b>Ctrl%Ny x Ctrl%Ny </b>in size. (Off-diagonals indicatiing correlations
are set to zero although any known correlations between channel noise values
shoud be included.)
<p><b><font color="#33CC00">2. Sup-pixel dependent terms:</font></b>
<br>As the super-pixel is defined (Get_SPixel routine; specifically <b>Get_Measurements
</b>or
a dedicated routine <b>Get_Sy</b>), a measurement covariance specific to
the super-pixel is defined: <b>SPixel.Sy</b> with allocatable size
<b>SPixel%Ny
x SPixel%Ny</b>. The approriate channel values from Ctrl%Sy are loaded
into Spixel%Sy.
<br>Super-pixel dependent terms (HOMOG and COREG) are added if requested
(Ctrl%Eqmpn%Homog etc flags). The appropriate noise terms are held in the
SAD_CHAN structure (SAD_CHAN()%NeHomog etc). (Note that SAD_CHAN()%NeHomog
etc are functions of cloud type (1-5) and the flag indicates which cloud
type to use. Under the current ECP, the cloud type is fixed to the value
specified in the driver file, but it is anticipated that either ECP internal
code (e.g. state dependent; local measurement spatial coherence tests etc)
or auxilary files would supply a dynamic value of the cloud type.
<p><b><font color="#33CC00">3. State dependent terms:</font></b>
<br>Within the inversion loop the current best estimate of the state is
constantly updated. As it is, a local variable Sy (dimension SPixel%Ny
x SPixel%Ny) is updated (in <b>Set_Sy</b> routine): <b>Sy = SPixel%Sy +
State-dependent terms</b>. Generally the state-dependent term takes the
form <b>dY/db. Sb<sup>-1</sup>. dY/db<sup>T</sup></b> where dY/db is the
gradient of the measurements used with respect to the parameter in question
(also denoted <b>Kb</b>) and Sb is the parameters error covariance.
<hr WIDTH="100%">
</body>
</html>
